---
layout: post
title: Windows Shellbags and Post Exploitation
date: '2011-09-30T10:25:00.000+02:00'
author: Xavier Garcia
tags:
- post explotation
- meterpreter
modified_time: '2011-09-30T10:25:37.191+02:00'
blogger_id: tag:blogger.com,1999:blog-8534555958859253862.post-8022954642563666953
blogger_orig_url: http://www.shellguardians.com/2011/09/windows-shellbags-and-post-exploitation.html
---
Via [securityaegis](http://www.securityaegis.com/post-exploitation-shellbag-ing/) and seen in Twitter .

[Shellbags](http://www.shellguardians.com/2011/07/windows-shellbags-and-timeline-analysis.html) are a set of registry keys that store the preferences of each folder that has been opened **at l east one time** with Windows Explorer (local,remote, portable devices, etc.).

From a Post Exploitat ion point of view, this information offers us a good idea of the activities being carried in the exploited deskt op computer. Thus, we can figure out how critical the computer and the the information it holds are for our cost umer.

The linked post comments that, during a big engagement, we may pop up a shell in a computer tha t belongs to HR, R&D, etc..Â  but, at first sight, we could not distinguish how important it is compared to several other similar desktops among the organization.

Below you can find a demo of the meterpret er script in action.

<iframe allowfullscreen="" frameborder="0" height="225" src="http://player.vimeo.com/video/29823214?title=0&amp;byline=0&amp;portrait=0" webkitallowfullscreen="" width="400"></iframe>

[Shellbag](http://vimeo.com/29823214) from [Securityae gis](http://vimeo.com/user1489298) on [Vimeo](http://vimeo.com/) 
