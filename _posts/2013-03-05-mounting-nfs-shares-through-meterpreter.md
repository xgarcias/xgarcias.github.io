---
layout: post
title: Mounting NFS shares through Meterpreter
date: '2013-03-05T10:52:00.000+01:00'
author: Xavier Garcia
tags:
- pentest
- nfs
- meterpreter
modified_time: '2013-03-05T10:52:06.388+01:00'
blogger_id: tag:blogger.com,1999:blog-8534555958859253862.post-1232133840877338008
blogger_orig_url: http://www.shellguardians.com/2013/03/mounting-nfs-shares-through-meterpreter.html
---
This blog post is a quick resume on the subject and you can find all the details in the [blog post](http://www.room362.com/blog/2013/3/4/mounting-nfs-shares-through-meterpreter-with-nfspy.html) written by Rob Fuller.

The idea behind this technique is that you have managed to create a Meterpreter session in a network and you have spotted (though a network scan or in configuration files) a server exporting data with NFS. Of course, you do not want to mess with the box and lose the shell so the solution is to tunnel all this NFS traffic though Meterpreter all the way to your own box.

Rob Fuller proposes the following setup:
* Route all the connections to the target network through the active Meterpreter session.
* Run Metasploit's Socks proxy in the background so we can run external programs against our target. In combination with the previous point, the traffic generated by our external program will be routed to the remote network through our Meterpreter session.
* Use an NFS client to mount the remote volumes in your box. The problem here is that this client **must** support TCP connections because the programs used to "socksify" (like proxychains) only supports TCP packets.

The proposed NFS client is [NfSpy](https://github.com/bonsaiviking/NfSpy)Â  for a simple reason, it was written to abuse the trust relationships in NFS before version 4 (NFSv4 uses Kerberos for authentication), that is almost all the systems you may find in a pentest. Abusing these relationships you can bypass security restrictions like **squash_root** (a legit NFS library would treat root like the nobody user). You can find detailed information in the [README](https://github.com/bonsaiviking/NfSpy/blob/master/README.md) file.
