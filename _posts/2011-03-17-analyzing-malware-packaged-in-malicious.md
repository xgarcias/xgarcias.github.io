---
layout: post
title: Analyzing malware packaged in malicious PDF files
date: '2011-03-17T09:43:00.003+01:00'
author: Xavier Garcia
tags:
- analysis
- malware
- pdf
modified_time: '2011-03-17T09:45:23.347+01:00'
blogger_id: tag:blogger.com,1999:blog-8534555958859253862.post-4335968073596441385
blogger_orig_url: http://www.shellguardians.com/2011/03/analyzing-malware-packaged-in-malicious.html
---
Great [post](http://research.zscaler.com/2011/03/analyzing-pdf-exploits-for-finding.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3A+zscaler%2Fresearch+%28Zscaler+Research%29&utm_content=Google+Reader) from [research.zscaler.com](http://research.zscaler.com/)  
  
It explains how to analyze a  PDF that contains malicious code.  The following steps are followed during the analysis.  
  
  
* Analyze/Extract the different objects from the PDF file.  The file contains javascript code in this case.
* Use [Malzilla](http://malzilla.sourceforge.net/) to evaluate the javascript code and extract the shellcode that is Unicode encoded.
* Decode the shellcode to obtain a valid executable binary.
* Use a debugger ( OllyDbg) to analyze the binary. The analyst extracts the XOred code from the binary.
* Use a debugger again to analyze the extracted code. It contacts a website to download the second stage and infect the host computer.
